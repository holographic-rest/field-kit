# Holologue Spec v0.1

## 1) Front Matter

* **Title:** Holologue Spec v0.1
* **Version:** v0.1
* **Date:** 2025-12-16
* **Status:** Draft
* **Suggested repo path:** `/docs/specs/04_holologue_spec_v0.1.md`

## 2) Purpose

Holologue is Field-Kit’s topology-aware **many → one** operator. It enables creation of a **single concrete, usable artifact Item** from a constellation of multiple Items (and optionally nearby graph context), beyond what unary Bond execution produces. Holologue supports workshop workflows (draft, edit, iterate) by generating a new persistent artifact with explicit provenance and an auditable event trail, and it provides a future path to publishing/curation by producing stable artifacts that can later be curated—without equating “Holologue output” with publishing or canonical truth.

### Terms (v0.1)

* **Episode:** A local, user-owned container for one working session. Every persisted object and every QDPIEvent belongs to exactly one Episode via `episode_id`.
* **Item:** A persistent node of content in the Field, created by a user or generated by an operator. Items are addressable by ID and include a `type` (e.g., `Q`, `M`, `D`, `H`) plus content and minimal metadata.
* **Bond:** A persistent instruction that connects one or more input Items to an operator run. `prompt_text` is the primary instruction. Bonds are created as `status:"draft"` and may be executed; execution generates exactly one output Item and MUST set `status:"executed"` and `output_item_id`.
* **QDPIEvent:** An append-only event record that logs meaningful actions and results. Each event includes `qdpi` (Queue/Monologue/Dialogue/Holologue), `direction` (user→field or system→field), a `name`, a timestamp, and refs to related object IDs.
* **Proposal:** A system suggestion (e.g., suggested Bond prompts) that is logged as events only until the user explicitly confirms creation.
* **Canon:** A user-curated projection over Items/Bonds within an Episode used for presentation or replay. Canon never overrides the append-only event log.
* **Bundle:** A structured artifact output of a Holologue run (many→one) capturing what was selected, what was generated, and any optional proposals. A Bundle may be represented as a single output Item plus an exportable JSON payload.

## 3) Scope and Non-goals (v0.1)

### In scope (v0.1)

* **Private • Local:** no accounts, no cloud sync, no collaboration, no publishing.
* **Explicit user-invoked runs only:** Holologue runs only when the user selects 2+ Items and taps **Run Holologue** (no background/ambient runs).
* **Holologue produces exactly ONE output Item per run** (Item type `"H"`).
* **Holologue may propose Bond prompts as events only** (no automatic Bond creation).
* **Quality gate + one regeneration attempt** to enforce anti-summary constraints (see Sections 8 and 12).

### Non-goals (v0.1)

* No ambient/automatic Holologues (e.g., “always running in the background”).
* No cross-user sharing, collaboration, cloud sync, accounts, or publishing.
* No “summary-by-default” mode: Holologue is not designed to recap content unless the user explicitly targets a recap-like artifact (and even then, must remain concrete and usable).

## 4) Core Principles

* **Many → one artifact:** one run creates exactly one output Item.
* **Not summary-by-default:** output is a concrete artifact, not a recap.
* **Topology-aware:** reads Items plus optional nearby graph context (Bonds + provenance), not just raw text.
* **Provenance first-class:** output Item records `created_by="holologue"`, `holologue_event_id`, `selected_item_ids`, `artifact_kind`.
* **Proposals are suggestions only:** any follow-on Bond prompts are emitted as events (not persisted Bonds) until user confirms.
* **Auditability via QDPIEvents:** runs, outcomes, and failures are logged as append-only, immutable events.
* **User confirmation governs persistence:** the user initiates the run; the system persists outputs with explicit ledger entries.
* **Multi-purpose outputs:** no hardcoded tone; suitable for technical/spec, scientific, creative, planning.
* **Grounded novelty:** output must add a usable new object traceable to the constellation.

## 5) Definitions

> This section defines Holologue-specific terms beyond **Terms (v0.1)**.

**Constellation**
The set of user-selected Items (`selected_item_ids`, length ≥ 2), plus optional nearby topology data included for context (executed Bonds touching selected Items; optionally link-only Bonds as adjacency).

**Artifact**
The single output Item created by a Holologue run (`type: "H"`). It must be concrete and usable (plan, checklist, experiment, spec fragment, story beat, or custom).

**Artifact kind**
A target category that guides format and specificity. v0.1 supports preset kinds plus free text:

* Presets: `plan | experiment | checklist | spec_fragment | story_beat`
* Free-text: any string (stored as-is)

**Abstraction direction (optional)**
A hint about the intended transformation:

* `generalize` (specific→general model)
* `instantiate` (general→specific plan/spec)
* `translate` (sideways mapping/bridge)
* `meta` (H→H recomposition)

In v0.1 this is optional; default is inferred from `artifact_kind` and `artifact_target_text`.

**Trace (evidence without recap)**
A minimal, standardized structure showing what the Holologue used, without becoming “summary-by-default.” In v0.1, trace is recorded in event `refs` as:

* `trace.references[]` where each reference has:

  * `item_id` (string)
  * `role` (string; one of: `selected_input | provenance_parent | executed_bond_context | link_bond_adjacency | output_artifact | dropped_from_selection | dropped_from_context`)
  * optional `snippet` (short string; ≤ 140 chars; debug-friendly)

**Proposal**
A suggested Bond prompt emitted as an event (e.g., `bond.proposals.presented`) containing 4 content-shaped `prompt_text` strings and optional inferred labels (`intent_type`). Proposals are not Bonds until user confirms.

## 6) Triggers

### UI trigger (v0.1)

1. User multi-selects **2+ Items** on the canvas.
2. User taps **Run Holologue**.

### Parameters (v0.1)

* **Required:** `artifact_kind` selection (preset + “Custom…” free text)
* **Optional:** `artifact_target_text` (“What do you want to produce?”)
* **Optional (advanced):** `abstraction_direction` (defaults inferred)
* **Optional:** `include_edges` toggle (include nearby Bonds as context)

### Validation rules

* `selected_item_ids.length >= 2`
* All selected Items must belong to the same `network_id`.
* v0.1 default: all selected Items must belong to the same `episode_id` (the active Episode). If not, validation fails (no cross-episode Holologues in v0.1).
* If `include_edges=true`, only Bonds with `status:"executed"` are treated as semantic lineage; link-only Bonds are treated as adjacency only.
* If selection or context exceeds limits (`max_items` / `max_bonds`), v0.1 uses **deterministic truncation** (not validation failure). The truncation is recorded in `trace.references` (see Sections 7 and 12).

## 7) Inputs (implementation-level)

> TypeScript request shape for v0.1 (consistent style for this doc).

```ts
export type HolologueArtifactKindPreset =
  | "plan"
  | "experiment"
  | "checklist"
  | "spec_fragment"
  | "story_beat";

export type HolologueArtifactKind = HolologueArtifactKindPreset | (string & {});

export type HolologueAbstractionDirection =
  | "generalize"
  | "instantiate"
  | "translate"
  | "meta";

export type HolologueSelectionMode = "manual"; // v0.1 only

export type HolologueRunRequest = {
  // REQUIRED
  network_id: string;                // nw_...
  episode_id: string;                // ep_... (active episode)
  selected_item_ids: string[];       // >=2
  artifact_kind: HolologueArtifactKind;

  // OPTIONAL
  artifact_target_text?: string;     // "What do you want?" free-text
  abstraction_direction?: HolologueAbstractionDirection; // optional hint; default inferred
  include_edges?: boolean;           // default true
  max_items?: number;                // default 12 (hard cap)
  max_bonds?: number;                // default 24 (hard cap)
  selection_mode?: HolologueSelectionMode; // v0.1 fixed: "manual"
};
```

### What topology data Holologue is allowed to read (v0.1)

Holologue may read:

* Selected Items: `id, type, title, body, provenance, created_at, updated_at`
* Executed Bonds that touch selected Items (if `include_edges=true`):

  * `input_item_ids, prompt_text, status, output_item_id, intent_type (optional), executed_at`
* Link-only Bonds that touch selected Items (optional adjacency only):

  * treated as *user-authored connective prompts*, not semantic truth
* Event-derived signals (optional, if present):

  * whether prior proposals were accepted or dismissed (from event refs), as weak guidance for suggestion diversity

### Deterministic truncation rules (v0.1)

If limits are exceeded, Holologue proceeds with a deterministic subset:

* **Selected items truncation (`max_items`):**

  * `used_selected_item_ids = selected_item_ids.slice(0, max_items)`
  * Dropped IDs are recorded as `trace.references` entries with `role:"dropped_from_selection"`.

* **Context bonds truncation (`max_bonds`, when `include_edges=true`):**

  * Collect 1-hop Bonds touching `used_selected_item_ids`.
  * Sort deterministically by priority then time/id:

    1. executed Bonds where **both** endpoints are within `used_selected_item_ids` (or within included provenance parents if used)
    2. executed Bonds where **at least one** endpoint is within `used_selected_item_ids`
    3. link-only Bonds touching `used_selected_item_ids` (adjacency only)
  * Within each bucket sort by `(executed_at || created_at)` ascending, then `id` ascending.
  * Keep first `max_bonds`; dropped bond IDs are recorded in `refs.dropped_bond_ids` and (optionally) `trace.references` entries with `role:"dropped_from_context"` pointing to a representative affected Item (not required).

## 8) Operator Behavior (v0.1 pipeline)

Holologue behavior is intentionally lightweight and testable.

### A) Gather constellation

* Fetch all selected Items by `selected_item_ids`.
* Validate membership in the provided `network_id` and `episode_id`.
* If `selected_item_ids.length > max_items`, apply deterministic truncation (Section 7).
* Preserve selection order as provided by UI for deterministic tie-breaking (but do not assume it implies importance).

### B) Optional topology expansion

If `include_edges=true`:

* Gather **1-hop** Bonds touching selected Items:

  * Executed Bonds: include as lineage context (inputs → output).
  * Draft/link-only Bonds: include as adjacency prompts only.
* If bond count exceeds `max_bonds`, apply deterministic truncation (Section 7).
* Optional provenance parents:

  * If a selected Item was created by Bond or Holologue, you may include its immediate provenance parents (the input item IDs) **only if within max_items**.

### C) Generate candidate artifacts (N = 2–4)

Generate 2–4 candidate artifacts that satisfy `artifact_kind` and (if provided) `artifact_target_text`. Candidates must be concrete (plan/checklist/spec fragment/etc.) and must incorporate multiple inputs.

### D) Select ONE artifact

Select exactly one candidate using these criteria (in order):

1. **Specificity:** produces a concrete artifact with structure (steps, checklist, schema fields, hypotheses, etc.), not a recap.
2. **Novelty:** adds a usable new object that is not verbatim from any single input.
3. **Groundedness:** traceable to the constellation via references (uses multiple selected Items).
4. **Adherence:** follows `artifact_kind` constraints and `artifact_target_text`.
5. **Topology coherence:** does not contradict obvious lineage (e.g., an Item derived from Bond output) unless explicitly framed as conflict resolution.

### E) Quality gate (anti-summary, testable) + one regeneration attempt

Before persisting anything, apply a deterministic quality gate to the selected artifact. The gate must be cheap and testable:

**Gate heuristics (v0.1)**

* **H1: Structure-by-kind**

  * If `artifact_kind="plan"`: artifact must contain **≥ 3 steps**, detected by either:

    * ≥3 lines starting with `^\d+[\.\)]\s` OR
    * ≥3 lines starting with `^Step\s+\d+` (case-insensitive)
  * If `artifact_kind="checklist"`: artifact must contain **≥ 5 checklist entries**, detected by either:

    * ≥5 lines starting with `^- \[ \]` or `^- \[[xX]\]` OR
    * ≥5 bullet lines starting with `^- ` and containing at least one constraint word (`must|should|require|only|never`, case-insensitive)
  * If `artifact_kind="experiment"`: artifact must contain **at least 3** of these headings (case-insensitive): `Hypothesis`, `Method`, `Metric`, `Stop rule`, `Controls`.
  * If `artifact_kind="spec_fragment"`: artifact must contain **≥ 3 normative statements**, detected by either:

    * ≥3 occurrences of `MUST`/`MUST NOT`/`SHOULD`/`SHOULD NOT` OR
    * ≥3 lines starting with `Rule:` or `Invariant:` (case-insensitive)
  * If `artifact_kind="story_beat"`: artifact must contain **≥ 3 beats**, detected by ≥3 lines starting with `Beat` or a numbered/bulleted list of ≥3 lines.
  * If `artifact_kind` is custom/other: artifact must include either:

    * ≥3 numbered lines OR
    * ≥4 bullet lines OR
    * ≥2 section headers ending with `:` (e.g., `Criteria:`)

* **H2: Novelty / non-recap**

  * Compute 5-gram overlap ratio between artifact and concatenated input text (casefolded, whitespace-normalized):

    * `overlap_ratio = (# artifact 5-grams that appear in inputs) / (total artifact 5-grams)`
  * Require `overlap_ratio <= 0.65`.

* **H3: Concrete addition**

  * Artifact must include at least one “concrete payload” marker:

    * a number (`\d`) **and**
    * at least one of: `criteria|metric|schema|decision|steps|checklist|hypothesis|constraints|acceptance` (case-insensitive)

**If the gate fails**

* Perform **one** regeneration attempt:

  * regenerate candidates with an explicit instruction: “produce a concrete artifact; include required structure; avoid paraphrase recap; satisfy novelty and concrete payload.”
  * re-run the quality gate.
* If the gate fails again:

  * do **not** persist an output Item
  * append `holologue.failed` with `reason:"quality_gate_failed"` and include `quality_gate` results in `refs` (Section 10)
  * do not append `holologue.completed`
  * do not emit `bond.proposals.presented`

### F) Optional proposals (events only)

After a successful completion (output persisted + `holologue.completed` logged), optionally generate **4 Bond prompt proposals**:

* Each proposal is a content-shaped `prompt_text` that includes a noun/phrase from the artifact or one of the selected Items.
* Proposals must be diverse; optional inferred `intent_type` labels may be included to diversify.
* Proposals are emitted as a **QDPIEvent** only (`bond.proposals.presented`, `qdpi:"Q"`, `direction:"system→field"`), not as Bonds.

## 9) Outputs

### Persistence rules (v0.1)

A successful Holologue run must:

1. Create exactly one output Item:

   * `type: "H"`
   * `provenance.created_by="holologue"`
   * `provenance.holologue_event_id` referencing the completion event ID
   * `provenance.selected_item_ids` (>=2; the **used** set after truncation)
   * `provenance.artifact_kind`
2. Append QDPIEvents in the correct order/atomicity (Section 10):

   * `holologue.run_requested`
   * (on success) `holologue.completed`
   * (optional) `bond.proposals.presented` **only after** successful completion
   * `store.commit` / `store.commit_failed` as appropriate
   * (optional simulation) `credits.delta` events may be appended for spend/refund/reward (Section 11)
3. Render the output Item on canvas and surface “View Ledger” (render events are debug-only and not logged by default).

### Bundle (exportable JSON payload; optional)

A Bundle is an optional structured payload derived from persisted objects + events (see **Terms (v0.1)**). It does not introduce a new required core object.

```json
{
  "network_id": "nw_01JFHOLO01NET00000000000001",
  "episode_id": "ep_01JFHOLO01EP000000000000001",
  "selected_item_ids": [
    "it_01JFHOLO01A00000000000000001",
    "it_01JFHOLO01B00000000000000001"
  ],
  "artifact_kind": "plan",
  "abstraction_direction": "instantiate",
  "output_item_id": "it_01JFHOLO01OUTH00000000000001",
  "proposals": [
    { "prompt_text": "Expand the plan into a 7-step checklist with acceptance criteria.", "intent_type": "expands" },
    { "prompt_text": "Ground step 3 with a measurable metric and a stop rule.", "intent_type": "grounds_in" },
    { "prompt_text": "Clarify the assumptions the plan depends on (3 bullets).", "intent_type": "clarifies" },
    { "prompt_text": "Fork two variants: fastest path vs most rigorous path.", "intent_type": "forks" }
  ],
  "trace": {
    "references": [
      { "item_id": "it_01JFHOLO01A00000000000000001", "role": "selected_input", "snippet": "prove persistence in first-run" },
      { "item_id": "it_01JFHOLO01B00000000000000001", "role": "selected_input", "snippet": "teach 3 tutorial moves" },
      { "item_id": "it_01JFHOLO01OUTH00000000000001", "role": "output_artifact" }
    ]
  }
}
```

## 10) Event Logging (QDPIEvents) — REQUIRED

Holologue relies on append-only immutable QDPIEvents. The following events are required and their tags are fixed.

### Required events

* `holologue.run_requested`

  * **qdpi:** `"H"`
  * **direction:** `user→field`
  * **when:** user presses **Run Holologue**
  * **refs MUST include:** `selected_item_ids`, `artifact_kind`, optional `artifact_target_text`, optional `abstraction_direction`

* `holologue.validation_failed`

  * **qdpi:** `"H"`
  * **direction:** `user→field`
  * **when:** request fails validation (selection too small, wrong network/episode, etc.)
  * **refs MUST include:** `reason` (e.g., `selection_too_small|network_mismatch|episode_mismatch`)

* `holologue.completed`

  * **qdpi:** `"H"`
  * **direction:** `system→field`
  * **when:** output Item is persisted successfully (see atomicity below)
  * **refs MUST include:** `selected_item_ids` (used set), `output_item_id`, `artifact_kind`, optional `abstraction_direction`, and `trace`

* `holologue.failed`

  * **qdpi:** `"H"`
  * **direction:** `system→field`
  * **when:** generation fails, quality gate fails, or persistence fails
  * **refs MUST include:** `reason` (one of: `generation_failed|quality_gate_failed|commit_failed`) and MAY include `trace`, `attempts`, and `quality_gate` results

* `bond.proposals.presented`

  * **qdpi:** `"Q"`
  * **direction:** `system→field`
  * **when:** Holologue emits 4 bond prompt proposals (suggestions only), **only after successful `holologue.completed`**
  * **refs MUST include:** `source.output_item_id`, `suggestions[4]`, and MAY include `trace`

* `store.commit` / `store.commit_failed`

  * **qdpi:** `"Q"`
  * **direction:** `system→field`
  * **when:** persistence succeeds/fails

### Ordering / atomicity rules (v0.1)

These are normative and testable:

1. `holologue.completed` **MUST only be logged after** the output Item is persisted successfully.
2. If persistence fails:

   * log `store.commit_failed`
   * log `holologue.failed` with `reason:"commit_failed"`
   * **DO NOT** log `holologue.completed`
   * **DO NOT** log `bond.proposals.presented`
3. `bond.proposals.presented` **MUST only occur after** successful `holologue.completed` (and therefore after the output Item exists).

**Recommended implementation approach**

* SQLite: use a transaction that persists the output Item and then appends `holologue.completed` (and optionally `bond.proposals.presented`) in-order before committing.
* JSONL: write the output Item record first (durable append), then append `holologue.completed`, then append `bond.proposals.presented`. If any step fails, follow the failure rules above.

### Clarifications

* `ledger.opened` is **Queue** (`qdpi:"Q"`) and is unrelated to Holologue runs.
* Render/paint/layout events are **not logged by default** in v0.1; if captured, they must be marked `is_debug:true` and may use `direction:"field→user"` as **debug-only** (avoid in normative v0.1 examples).

## 11) Credits hooks (v0.1 simulation)

Credits hooks attach to Holologue runs without introducing new required objects or any real-world value.

### What Credits are (and are not) in v0.1

* Credits are **local-only** and **purely simulated** in v0.1.
* Credits are **not transferable**, **not redeemable**, and have **no USD exchange rate** in v0.1.
* Credits are represented as **append-only QDPIEvents** and balance is a **derived view** (no new required core object).

### Standard credits event pattern (v0.1)

* **Event name:** `credits.delta`

* **qdpi:** `"Q"`

* **direction:** `system→field`

* `refs` MUST include:

  * `delta` (int; + or -)
  * `balance_after` (int)
  * `reason` (string)

* Optional related refs (when applicable):

  * `run_event_id` (typically the `holologue.run_requested` event id)
  * `holologue_event_id` (typically the `holologue.completed` / `holologue.failed` event id)
  * `output_item_id`

### Minimal default credit policy for Holologue actions (v0.1 defaults)

These are **defaults** for v0.1 and may be tuned later, but are treated as stable within v0.1.

* On `holologue.run_requested` → spend **-20** credits (`reason:"holologue_run_spend"`)
* On `holologue.failed` → refund **+20** credits (`reason:"holologue_run_refund"`) so failures don’t burn credits
* On `holologue.completed` → reward **+5** credits (`reason:"holologue_completed_reward"`)

## 12) Invariants & Constraints (v0.1)

* **Selection size:** `selected_item_ids.length >= 2`
* **Network consistency:** all selected Items must share the same `network_id` as the request.
* **Episode consistency:** v0.1 requires all selected Items share the same `episode_id` as the request (active episode).
* **Deterministic truncation:** if selection/context exceeds limits, truncate deterministically per Section 7 and record via `trace.references` (dropped items as `role:"dropped_from_selection"`; dropped context may be recorded via `refs.dropped_bond_ids`).
* **Single output:** exactly **ONE** output Item is created per successful run.
* **No automatic Bonds:** proposals are events only; no Bond objects are created without user confirmation.
* **Provenance immutability:** output Item provenance is immutable after creation.
* **Anti-summary constraint (quality gate enforced):**

  * artifact must pass the quality gate heuristics (Section 8E), including structure-by-kind, novelty threshold (`5-gram overlap_ratio <= 0.65`), and concrete payload marker
  * if the gate fails twice (initial + one regeneration), the run fails with `holologue.failed reason="quality_gate_failed"` and no output Item is created
* **Multi-purpose constraint:** no hardcoded tone or domain; `artifact_kind` shapes format, not voice.
* **Topology constraint:** executed Bonds may be treated as lineage; link-only Bonds are adjacency prompts only (do not assume semantic truth).

## 13) UX Notes (minimal, implementable)

* **Multi-select UI:** lasso or shift-click equivalent; show a selection count chip (e.g., “Selected: 3”).
* **Run Holologue button:** enabled only when selection count ≥ 2.
* **Artifact kind modal:**

  * Presets: Plan, Experiment, Checklist, Spec Fragment, Story Beat
  * Custom input: free text stored as `artifact_kind`
  * Optional target text: “What do you want to produce?”
  * Optional advanced: “Direction” dropdown (Generalize / Instantiate / Translate / Meta)
* **Limits UX:** if the user selects more than `max_items`, show a non-blocking warning: “Using first 12 selected items (limit).” (Back-end still truncates deterministically regardless of UI.)
* **Output placement:** create the output Item near the centroid of the selected Items; draw a subtle lineage badge “Holologue” and show selected count (e.g., “from 3 items”).
* **Proposals UI:** show 4 prompt options under the output Item:

  * actions: **Create Bond**, **Edit**, **Dismiss**
  * creating a Bond from a proposal follows Bond Ontology rules (events-only proposals until confirmed)
* **Inspection:** toast or banner: “Saved ✓ Holologue created Item it_… · View Ledger”.

### Follow-on patterns (H→Q/M/D/H)

Holologue output Items (`type:"H"`) are designed to seed follow-on work without collapsing into a “chat thread.” In v0.1, follow-on behavior is mediated via **proposals as events only**:

* **H→M (most common in v0.1):** proposals like “Expand into checklist,” “Ground in metrics,” “Turn into test plan” create Bonds whose execution produces an `Item` of type `"M"`.
* **H→D:** proposals like “Write a decision record,” “Compare two approaches with criteria,” “Argue for/against” create Bonds whose execution produces an `Item` of type `"D"`.
* **H→Q:** proposals like “Generate the next 3 questions to investigate” may create Bonds whose execution produces a new `Item` of type `"Q"` (allowed by the Item type enum), or may be implemented as a UI shortcut that creates Q Items directly (still logged as state-changing operations).
* **H→H (future):** recomposition of multiple artifacts (meta) is intentionally out of scope for v0.1 beyond the optional `abstraction_direction:"meta"` hint; treat as future operator work.

## 14) Failure modes & edge cases

1. **Selection too small (<2)**

   * Do not run; append `holologue.validation_failed` with reason `selection_too_small`.
2. **Items from different networks**

   * Fail validation; append `holologue.validation_failed` with reason `network_mismatch`.
3. **Items from different episodes (v0.1 rule)**

   * Fail validation; append `holologue.validation_failed` with reason `episode_mismatch`.
4. **Generation failure (model error/timeout)**

   * Append `holologue.failed` with `reason:"generation_failed"`; no output Item created.
   * If Credits simulation is enabled, refund is represented as a separate `credits.delta` event per Section 11.
5. **Quality gate failure**

   * One regeneration attempt is allowed.
   * If the gate fails again: append `holologue.failed` with `reason:"quality_gate_failed"` and include `quality_gate` metrics in refs; no output Item created.
   * If Credits simulation is enabled, refund is represented as a separate `credits.delta` event per Section 11.
6. **Storage failure (commit fails)**

   * Append `store.commit_failed`.
   * Append `holologue.failed` with `reason:"commit_failed"`.
   * Do not append `holologue.completed`.
   * Do not append `bond.proposals.presented`.
   * If Credits simulation is enabled, refund is represented as a separate `credits.delta` event per Section 11.
7. **Repeated runs from the same constellation**

   * Allowed; each run creates a new output Item; no overwrite; provenance must reference its own completion event.
8. **Include edges with inconsistent data**

   * If a Bond references missing Items, ignore that Bond for context and include a debug note (do not fail the run).
9. **Truncation cases**

   * If selection/context is truncated due to limits, the run proceeds deterministically; dropped inputs are recorded via `trace.references` with `role:"dropped_from_selection"`.

## 15) Metrics (recommended)

1. **Time to first Holologue run**

   * `t(holologue.run_requested) - t(app.first_run.started)` (or first app open event).
2. **Holologue success rate**

   * `holologue.completed / holologue.run_requested`
3. **Proposal acceptance rate**

   * `% of runs where a user creates a Bond draft from a proposal within 2 minutes`
4. **Artifact edit rate**

   * `% of Holologue outputs edited within 5 minutes of creation`
5. **Specificity heuristic**

   * `% of artifacts that satisfy structure-by-kind heuristics at first attempt (before regeneration)`

## 16) Worked Examples (at least 3)

> Notes:
>
> * All examples reuse the same `network_id` and `episode_id` (one primary local universe).
> * Direction values are normative: `user→field` and `system→field`.
> * Credits events (simulation) are shown once (Example 1) to demonstrate ordering and fields.

**Example universe IDs (reused)**

* `network_id`: `nw_01JFHOLO01NET00000000000001`
* `episode_id`: `ep_01JFHOLO01EP000000000000001`

---

### Example 1 — Deductive-style artifact (general→specific instantiation; `artifact_kind="plan"`) + Credits spend (simulation)

**Selected Items**

```json
[
  {
    "schema_version": 1,
    "id": "it_01JFHOLO01A00000000000000001",
    "network_id": "nw_01JFHOLO01NET00000000000001",
    "episode_id": "ep_01JFHOLO01EP000000000000001",
    "scope": "private",
    "type": "Q",
    "title": "We must prove persistence in first-run",
    "body": "Show object IDs and the append-only ledger; not just chat output.",
    "position": { "x": 0, "y": 0, "z": 0 },
    "provenance": { "created_by": "user" },
    "created_at": "2025-12-16T00:10:00.000Z",
    "updated_at": "2025-12-16T00:10:00.000Z"
  },
  {
    "schema_version": 1,
    "id": "it_01JFHOLO01B00000000000000001",
    "network_id": "nw_01JFHOLO01NET00000000000001",
    "episode_id": "ep_01JFHOLO01EP000000000000001",
    "scope": "private",
    "type": "Q",
    "title": "Guided Tutorial must teach 3 moves",
    "body": "Q→M suggested bond, Q→D user bond, (Q,Q)→H holologue.",
    "position": { "x": 1.1, "y": 0.0, "z": 0 },
    "provenance": { "created_by": "user" },
    "created_at": "2025-12-16T00:10:05.000Z",
    "updated_at": "2025-12-16T00:10:05.000Z"
  }
]
```

**Events — run requested, credits spend (simulation), completed**

```json
[
  {
    "schema_version": 1,
    "id": "ev_01JFHOLO01EV000000000000001",
    "network_id": "nw_01JFHOLO01NET00000000000001",
    "episode_id": "ep_01JFHOLO01EP000000000000001",
    "ts": "2025-12-16T00:10:10.000Z",
    "seq": 1,
    "qdpi": "H",
    "direction": "user→field",
    "actor": { "kind": "user", "id": "local-user", "display": "You" },
    "name": "holologue.run_requested",
    "refs": {
      "selected_item_ids": [
        "it_01JFHOLO01A00000000000000001",
        "it_01JFHOLO01B00000000000000001"
      ],
      "artifact_kind": "plan",
      "abstraction_direction": "instantiate",
      "artifact_target_text": "Turn these into a concrete 60-second tutorial plan with checkpoints."
    }
  },
  {
    "schema_version": 1,
    "id": "ev_01JFHOLO01EV000000000000002",
    "network_id": "nw_01JFHOLO01NET00000000000001",
    "episode_id": "ep_01JFHOLO01EP000000000000001",
    "ts": "2025-12-16T00:10:10.010Z",
    "seq": 2,
    "qdpi": "Q",
    "direction": "system→field",
    "actor": { "kind": "system", "id": "system", "display": "Field-Kit" },
    "name": "credits.delta",
    "refs": {
      "delta": -20,
      "balance_after": 80,
      "reason": "holologue_run_spend",
      "run_event_id": "ev_01JFHOLO01EV000000000000001"
    }
  },
  {
    "schema_version": 1,
    "id": "ev_01JFHOLO01EV000000000000003",
    "network_id": "nw_01JFHOLO01NET00000000000001",
    "episode_id": "ep_01JFHOLO01EP000000000000001",
    "ts": "2025-12-16T00:10:12.000Z",
    "seq": 3,
    "qdpi": "H",
    "direction": "system→field",
    "actor": { "kind": "system", "id": "system", "display": "Field-Kit" },
    "name": "holologue.completed",
    "refs": {
      "selected_item_ids": [
        "it_01JFHOLO01A00000000000000001",
        "it_01JFHOLO01B00000000000000001"
      ],
      "output_item_id": "it_01JFHOLO01OUTH00000000000001",
      "artifact_kind": "plan",
      "abstraction_direction": "instantiate",
      "trace": {
        "references": [
          { "item_id": "it_01JFHOLO01A00000000000000001", "role": "selected_input" },
          { "item_id": "it_01JFHOLO01B00000000000000001", "role": "selected_input" },
          { "item_id": "it_01JFHOLO01OUTH00000000000001", "role": "output_artifact" }
        ]
      }
    }
  }
]
```

**Output Item (H)**

```json
{
  "schema_version": 1,
  "id": "it_01JFHOLO01OUTH00000000000001",
  "network_id": "nw_01JFHOLO01NET00000000000001",
  "episode_id": "ep_01JFHOLO01EP000000000000001",
  "scope": "private",
  "type": "H",
  "title": "First-run plan (60s) with checkpoints",
  "body": "Checkpoint 1 (0–10s): Create Item Q with visible Saved ✓ + ID.\nCheckpoint 2 (10–25s): Select suggested Bond prompt → create draft → Run Bond → output Item M.\nCheckpoint 3 (25–40s): Write a Bond prompt → Run Bond → output Item D.\nCheckpoint 4 (40–55s): Select 2+ Items → Run Holologue → output Item H.\nCheckpoint 5 (55–60s): Open Ledger to inspect Items/Bonds/Events.\nPass criteria: at least one executed bond shows inputs→output lineage in Ledger.",
  "position": { "x": 0.6, "y": -1.0, "z": 0 },
  "provenance": {
    "created_by": "holologue",
    "holologue_event_id": "ev_01JFHOLO01EV000000000000003",
    "selected_item_ids": [
      "it_01JFHOLO01A00000000000000001",
      "it_01JFHOLO01B00000000000000001"
    ],
    "artifact_kind": "plan"
  },
  "created_at": "2025-12-16T00:10:12.000Z",
  "updated_at": "2025-12-16T00:10:12.000Z"
}
```

---

### Example 2 — Inductive-style artifact (specific→general; `artifact_kind="spec_fragment"`)

**Selected Items**

```json
[
  {
    "schema_version": 1,
    "id": "it_01JFHOLO02A00000000000000001",
    "network_id": "nw_01JFHOLO01NET00000000000001",
    "episode_id": "ep_01JFHOLO01EP000000000000001",
    "scope": "private",
    "type": "M",
    "title": "Observed failures in onboarding",
    "body": "Users confuse suggestions with saved objects; they think outputs are chat responses.",
    "position": { "x": 0, "y": -2.2, "z": 0 },
    "provenance": { "created_by": "user" },
    "created_at": "2025-12-16T00:12:00.000Z",
    "updated_at": "2025-12-16T00:12:00.000Z"
  },
  {
    "schema_version": 1,
    "id": "it_01JFHOLO02B00000000000000001",
    "network_id": "nw_01JFHOLO01NET00000000000001",
    "episode_id": "ep_01JFHOLO01EP000000000000001",
    "scope": "private",
    "type": "M",
    "title": "Event logging rule",
    "body": "Log state changes + key inspections. Render events debug-only (is_debug:true).",
    "position": { "x": 1.1, "y": -2.2, "z": 0 },
    "provenance": { "created_by": "user" },
    "created_at": "2025-12-16T00:12:10.000Z",
    "updated_at": "2025-12-16T00:12:10.000Z"
  },
  {
    "schema_version": 1,
    "id": "it_01JFHOLO02C00000000000000001",
    "network_id": "nw_01JFHOLO01NET00000000000001",
    "episode_id": "ep_01JFHOLO01EP000000000000001",
    "scope": "private",
    "type": "Q",
    "title": "What constraints prevent drift into 'chat'?",
    "body": "We need enforced lineage and visible persistence moments.",
    "position": { "x": 0.6, "y": -3.0, "z": 0 },
    "provenance": { "created_by": "user" },
    "created_at": "2025-12-16T00:12:20.000Z",
    "updated_at": "2025-12-16T00:12:20.000Z"
  }
]
```

**Events — run requested, completed**

```json
[
  {
    "schema_version": 1,
    "id": "ev_01JFHOLO02EV000000000000001",
    "network_id": "nw_01JFHOLO01NET00000000000001",
    "episode_id": "ep_01JFHOLO01EP000000000000001",
    "ts": "2025-12-16T00:12:25.000Z",
    "seq": 4,
    "qdpi": "H",
    "direction": "user→field",
    "actor": { "kind": "user", "id": "local-user", "display": "You" },
    "name": "holologue.run_requested",
    "refs": {
      "selected_item_ids": [
        "it_01JFHOLO02A00000000000000001",
        "it_01JFHOLO02B00000000000000001",
        "it_01JFHOLO02C00000000000000001"
      ],
      "artifact_kind": "spec_fragment",
      "abstraction_direction": "generalize",
      "artifact_target_text": "Derive a small set of invariants for 'not chat' behavior."
    }
  },
  {
    "schema_version": 1,
    "id": "ev_01JFHOLO02EV000000000000002",
    "network_id": "nw_01JFHOLO01NET00000000000001",
    "episode_id": "ep_01JFHOLO01EP000000000000001",
    "ts": "2025-12-16T00:12:28.000Z",
    "seq": 5,
    "qdpi": "H",
    "direction": "system→field",
    "actor": { "kind": "system", "id": "system", "display": "Field-Kit" },
    "name": "holologue.completed",
    "refs": {
      "selected_item_ids": [
        "it_01JFHOLO02A00000000000000001",
        "it_01JFHOLO02B00000000000000001",
        "it_01JFHOLO02C00000000000000001"
      ],
      "output_item_id": "it_01JFHOLO02OUTH00000000000001",
      "artifact_kind": "spec_fragment",
      "abstraction_direction": "generalize",
      "trace": {
        "references": [
          { "item_id": "it_01JFHOLO02A00000000000000001", "role": "selected_input" },
          { "item_id": "it_01JFHOLO02B00000000000000001", "role": "selected_input" },
          { "item_id": "it_01JFHOLO02C00000000000000001", "role": "selected_input" },
          { "item_id": "it_01JFHOLO02OUTH00000000000001", "role": "output_artifact" }
        ]
      }
    }
  }
]
```

**Output Item (H)**

```json
{
  "schema_version": 1,
  "id": "it_01JFHOLO02OUTH00000000000001",
  "network_id": "nw_01JFHOLO01NET00000000000001",
  "episode_id": "ep_01JFHOLO01EP000000000000001",
  "scope": "private",
  "type": "H",
  "title": "Invariants: persistence + lineage + meaningful logging",
  "body": "Invariant 1: Outputs must be persisted as Items with stable IDs.\nInvariant 2: Executed Bonds must show inputs→output lineage (Bond.output_item_id and Item.provenance).\nInvariant 3: Suggestions are events only until user confirms (no silent structure).\nInvariant 4: Holologue produces exactly one artifact Item per run.\nInvariant 5: Log state changes + key inspections; render events debug-only (is_debug:true).\nTest: A user can open Ledger and verify the chain from selection/run to output Item.",
  "position": { "x": 0.6, "y": -3.8, "z": 0 },
  "provenance": {
    "created_by": "holologue",
    "holologue_event_id": "ev_01JFHOLO02EV000000000000002",
    "selected_item_ids": [
      "it_01JFHOLO02A00000000000000001",
      "it_01JFHOLO02B00000000000000001",
      "it_01JFHOLO02C00000000000000001"
    ],
    "artifact_kind": "spec_fragment"
  },
  "created_at": "2025-12-16T00:12:28.000Z",
  "updated_at": "2025-12-16T00:12:28.000Z"
}
```

---

### Example 3 — Holologue emits 4 proposals leading to H→M follow-on (events only + user-confirmed Bond execution)

**Selected Items**

```json
[
  {
    "schema_version": 1,
    "id": "it_01JFHOLO03A00000000000000001",
    "network_id": "nw_01JFHOLO01NET00000000000001",
    "episode_id": "ep_01JFHOLO01EP000000000000001",
    "scope": "private",
    "type": "Q",
    "title": "We need a holologue UX that feels multi-purpose",
    "body": "Not hardcoded tone; should work for planning, science, and writing.",
    "position": { "x": 0, "y": -5.0, "z": 0 },
    "provenance": { "created_by": "user" },
    "created_at": "2025-12-16T00:14:00.000Z",
    "updated_at": "2025-12-16T00:14:00.000Z"
  },
  {
    "schema_version": 1,
    "id": "it_01JFHOLO03B00000000000000001",
    "network_id": "nw_01JFHOLO01NET00000000000001",
    "episode_id": "ep_01JFHOLO01EP000000000000001",
    "scope": "private",
    "type": "Q",
    "title": "How do we prevent holologue outputs from being recaps?",
    "body": "Require concrete structure and novelty; show evidence links.",
    "position": { "x": 1.1, "y": -5.0, "z": 0 },
    "provenance": { "created_by": "user" },
    "created_at": "2025-12-16T00:14:05.000Z",
    "updated_at": "2025-12-16T00:14:05.000Z"
  }
]
```

**Events — run requested, completed, proposals presented**

```json
[
  {
    "schema_version": 1,
    "id": "ev_01JFHOLO03EV000000000000001",
    "network_id": "nw_01JFHOLO01NET00000000000001",
    "episode_id": "ep_01JFHOLO01EP000000000000001",
    "ts": "2025-12-16T00:14:10.000Z",
    "seq": 6,
    "qdpi": "H",
    "direction": "user→field",
    "actor": { "kind": "user", "id": "local-user", "display": "You" },
    "name": "holologue.run_requested",
    "refs": {
      "selected_item_ids": [
        "it_01JFHOLO03A00000000000000001",
        "it_01JFHOLO03B00000000000000001"
      ],
      "artifact_kind": "checklist",
      "artifact_target_text": "Produce an acceptance checklist for holologue output quality."
    }
  },
  {
    "schema_version": 1,
    "id": "ev_01JFHOLO03EV000000000000002",
    "network_id": "nw_01JFHOLO01NET00000000000001",
    "episode_id": "ep_01JFHOLO01EP000000000000001",
    "ts": "2025-12-16T00:14:12.000Z",
    "seq": 7,
    "qdpi": "H",
    "direction": "system→field",
    "actor": { "kind": "system", "id": "system", "display": "Field-Kit" },
    "name": "holologue.completed",
    "refs": {
      "selected_item_ids": [
        "it_01JFHOLO03A00000000000000001",
        "it_01JFHOLO03B00000000000000001"
      ],
      "output_item_id": "it_01JFHOLO03OUTH00000000000001",
      "artifact_kind": "checklist",
      "trace": {
        "references": [
          { "item_id": "it_01JFHOLO03A00000000000000001", "role": "selected_input" },
          { "item_id": "it_01JFHOLO03B00000000000000001", "role": "selected_input" },
          { "item_id": "it_01JFHOLO03OUTH00000000000001", "role": "output_artifact" }
        ]
      }
    }
  },
  {
    "schema_version": 1,
    "id": "ev_01JFHOLO03EV000000000000003",
    "network_id": "nw_01JFHOLO01NET00000000000001",
    "episode_id": "ep_01JFHOLO01EP000000000000001",
    "ts": "2025-12-16T00:14:12.050Z",
    "seq": 8,
    "qdpi": "Q",
    "direction": "system→field",
    "actor": { "kind": "system", "id": "system", "display": "Field-Kit" },
    "name": "bond.proposals.presented",
    "refs": {
      "source": { "kind": "holologue", "output_item_id": "it_01JFHOLO03OUTH00000000000001" },
      "suggestions": [
        { "prompt_text": "Expand the checklist into a short test plan with pass/fail examples.", "intent_type": "expands" },
        { "prompt_text": "Clarify the anti-summary constraint into a single enforceable sentence for the spec.", "intent_type": "clarifies" },
        { "prompt_text": "Ground the checklist in 3 measurable heuristics (e.g., structure markers, decisions, novelty).", "intent_type": "grounds_in" },
        { "prompt_text": "Fork two UX variants: novice-friendly vs expert-fast, with tradeoffs.", "intent_type": "forks" }
      ],
      "trace": {
        "references": [
          { "item_id": "it_01JFHOLO03OUTH00000000000001", "role": "output_artifact" }
        ]
      }
    }
  }
]
```

**Output Item (H)**

```json
{
  "schema_version": 1,
  "id": "it_01JFHOLO03OUTH00000000000001",
  "network_id": "nw_01JFHOLO01NET00000000000001",
  "episode_id": "ep_01JFHOLO01EP000000000000001",
  "scope": "private",
  "type": "H",
  "title": "Holologue artifact quality checklist",
  "body": "Checklist:\n- Produces a usable artifact (plan/checklist/spec/etc.), not recap.\n- Includes at least one concrete decision/claim/structure not verbatim in inputs.\n- References multiple selected items (traceable).\n- No hardcoded tone; neutral by default.\n- Optional proposals are content-shaped and diverse.\n- Ledger shows run_requested → completed → saved item ID.",
  "position": { "x": 0.6, "y": -6.1, "z": 0 },
  "provenance": {
    "created_by": "holologue",
    "holologue_event_id": "ev_01JFHOLO03EV000000000000002",
    "selected_item_ids": [
      "it_01JFHOLO03A00000000000000001",
      "it_01JFHOLO03B00000000000000001"
    ],
    "artifact_kind": "checklist"
  },
  "created_at": "2025-12-16T00:14:12.000Z",
  "updated_at": "2025-12-16T00:14:12.000Z"
}
```

**Follow-on behavior (H→M) via user-confirmed Bond created from a proposal (end-to-end)**

```json
{
  "bond_draft": {
    "schema_version": 1,
    "id": "bd_01JFHOLO03BOND00000000000001",
    "network_id": "nw_01JFHOLO01NET00000000000001",
    "episode_id": "ep_01JFHOLO01EP000000000000001",
    "scope": "private",
    "input_item_ids": ["it_01JFHOLO03OUTH00000000000001"],
    "prompt_text": "Ground the checklist in 3 measurable heuristics (e.g., structure markers, decisions, novelty).",
    "intent_type": "grounds_in",
    "status": "draft",
    "output_item_id": null,
    "created_by": "user",
    "created_at": "2025-12-16T00:14:15.000Z",
    "updated_at": "2025-12-16T00:14:15.000Z"
  },
  "events": [
    {
      "schema_version": 1,
      "id": "ev_01JFHOLO03EV000000000000004",
      "network_id": "nw_01JFHOLO01NET00000000000001",
      "episode_id": "ep_01JFHOLO01EP000000000000001",
      "ts": "2025-12-16T00:14:15.050Z",
      "seq": 9,
      "qdpi": "D",
      "direction": "user→field",
      "actor": { "kind": "user", "id": "local-user", "display": "You" },
      "name": "bond.draft_created",
      "refs": {
        "bond_id": "bd_01JFHOLO03BOND00000000000001",
        "input_item_ids": ["it_01JFHOLO03OUTH00000000000001"],
        "prompt_text": "Ground the checklist in 3 measurable heuristics (e.g., structure markers, decisions, novelty).",
        "origin": "proposed_from_holologue",
        "proposal_event_id": "ev_01JFHOLO03EV000000000000003"
      }
    },
    {
      "schema_version": 1,
      "id": "ev_01JFHOLO03EV000000000000005",
      "network_id": "nw_01JFHOLO01NET00000000000001",
      "episode_id": "ep_01JFHOLO01EP000000000000001",
      "ts": "2025-12-16T00:14:16.000Z",
      "seq": 10,
      "qdpi": "Q",
      "direction": "user→field",
      "actor": { "kind": "user", "id": "local-user", "display": "You" },
      "name": "bond.run_requested",
      "refs": {
        "bond_id": "bd_01JFHOLO03BOND00000000000001",
        "requested_output_type": "M"
      }
    },
    {
      "schema_version": 1,
      "id": "ev_01JFHOLO03EV000000000000006",
      "network_id": "nw_01JFHOLO01NET00000000000001",
      "episode_id": "ep_01JFHOLO01EP000000000000001",
      "ts": "2025-12-16T00:14:17.000Z",
      "seq": 11,
      "qdpi": "M",
      "direction": "system→field",
      "actor": { "kind": "system", "id": "system", "display": "Field-Kit" },
      "name": "bond.executed",
      "refs": {
        "bond_id": "bd_01JFHOLO03BOND00000000000001",
        "input_item_ids": ["it_01JFHOLO03OUTH00000000000001"],
        "output_item_id": "it_01JFHOLO03OUTM00000000000001",
        "output_item_type": "M",
        "execution_count": 1
      }
    }
  ],
  "bond_executed": {
    "schema_version": 1,
    "id": "bd_01JFHOLO03BOND00000000000001",
    "network_id": "nw_01JFHOLO01NET00000000000001",
    "episode_id": "ep_01JFHOLO01EP000000000000001",
    "scope": "private",
    "input_item_ids": ["it_01JFHOLO03OUTH00000000000001"],
    "prompt_text": "Ground the checklist in 3 measurable heuristics (e.g., structure markers, decisions, novelty).",
    "intent_type": "grounds_in",
    "status": "executed",
    "output_item_id": "it_01JFHOLO03OUTM00000000000001",
    "executed_at": "2025-12-16T00:14:17.000Z",
    "execution_count": 1,
    "created_by": "user",
    "created_at": "2025-12-16T00:14:15.000Z",
    "updated_at": "2025-12-16T00:14:17.000Z"
  },
  "output_item_from_bond": {
    "schema_version": 1,
    "id": "it_01JFHOLO03OUTM00000000000001",
    "network_id": "nw_01JFHOLO01NET00000000000001",
    "episode_id": "ep_01JFHOLO01EP000000000000001",
    "scope": "private",
    "type": "M",
    "title": "3 measurable Holologue quality heuristics",
    "body": "Heuristic 1 (Structure): artifact meets kind-specific structure rules (e.g., plan has ≥3 steps).\nHeuristic 2 (Novelty): 5-gram overlap_ratio <= 0.65 against inputs.\nHeuristic 3 (Concrete payload): includes a number and at least one of: criteria/metric/schema/decision/acceptance.\nUse: fail → one regeneration → otherwise holologue.failed(reason=quality_gate_failed).",
    "position": { "x": 1.4, "y": -6.1, "z": 0 },
    "provenance": {
      "created_by": "bond",
      "bond_id": "bd_01JFHOLO03BOND00000000000001",
      "input_item_ids": ["it_01JFHOLO03OUTH00000000000001"]
    },
    "created_at": "2025-12-16T00:14:17.000Z",
    "updated_at": "2025-12-16T00:14:17.000Z"
  }
}
```

## 17) Definition of Done checklist (v0.1)

* [ ] UI supports selecting 2+ Items and enabling **Run Holologue**.
* [ ] Holologue validates `selected_item_ids.length >= 2`.
* [ ] Holologue enforces same `network_id` and (v0.1) same `episode_id` for all selected Items.
* [ ] Holologue enforces deterministic truncation when over limits:

  * [ ] item selection truncation recorded as `trace.references` entries with `role:"dropped_from_selection"`
  * [ ] bond context truncation uses deterministic priority+sort; dropped bond IDs recorded in `refs.dropped_bond_ids` (or equivalent)
* [ ] Holologue creates exactly ONE output Item per successful run:

  * [ ] `type:"H"`
  * [ ] `provenance.created_by:"holologue"`
  * [ ] `provenance.holologue_event_id`
  * [ ] `provenance.selected_item_ids` (>=2, used set)
  * [ ] `provenance.artifact_kind`
* [ ] Output Item provenance is immutable after creation.
* [ ] Quality gate is implemented and testable:

  * [ ] structure-by-kind checks
  * [ ] novelty check (`5-gram overlap_ratio <= 0.65`)
  * [ ] concrete payload marker check
  * [ ] one regeneration attempt; otherwise fail with reason `quality_gate_failed`
* [ ] Required QDPIEvents are appended with correct tags/directions and ordering:

  * [ ] `holologue.run_requested` (qdpi `H`, `direction:"user→field"`)
  * [ ] `holologue.completed` is logged **only after** output Item persistence succeeds
  * [ ] on commit failure: `store.commit_failed` + `holologue.failed(reason=commit_failed)` and **no** `holologue.completed`
  * [ ] `bond.proposals.presented` (qdpi `Q`, `direction:"system→field"`) only after successful `holologue.completed`
  * [ ] `holologue.validation_failed` and `holologue.failed` are used with explicit reasons
* [ ] No persistent Bond objects are created from Holologue proposals without user confirmation.
* [ ] Render/paint/layout events are not logged by default; if logged, marked `is_debug:true`.
* [ ] Credits simulation (if enabled) emits `credits.delta` events per Section 11:

  * [ ] spend on `holologue.run_requested`
  * [ ] refund on `holologue.failed`
  * [ ] reward on `holologue.completed`

## 18) Open Questions

1. Should Holologue treat link-only Bonds as semantic meaning or adjacency only? (v0.1: adjacency only; revisit later)
2. Where should trace live long-term: event `refs` only, debug-only payload, or also embedded in the output Item body as references?
3. Should v0.2 allow cross-episode Holologues within the same Network, and what does provenance mean across episodes?
4. Should `abstraction_direction` be exposed in UI, or inferred entirely from `artifact_kind` and target text?
5. Are the v0.1 quality gate thresholds (5-gram overlap `<= 0.65`, structure-by-kind) too strict/loose in practice, and should they be per-kind tuned?
6. Should Holologue propose Bonds based on topology (e.g., gaps between clusters) in addition to text content?
7. Should Holologue support including executed Bonds as first-class inputs (not only context) in a later version?
8. Should repeated runs from the same constellation be grouped (UI affordance) or treated as independent artifacts only?
9. Should proposal diversity be driven by the 12 inferred `intent_type` labels from Bond Ontology, or remain unconstrained?
10. Do we want an explicit “Bundle” stored anywhere beyond the output Item + events (v0.1: no; events + Item are sufficient)?
11. If JSONL storage is used, do we need a lightweight “two-phase” marker to prevent orphaned output Items without completion events on crash, or is this acceptable for v0.1?