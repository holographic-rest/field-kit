# UI/UX Foundations v0.1

## 1) Front Matter

* **Title:** UI/UX Foundations v0.1
* **Version:** v0.1
* **Date:** 2025-12-16
* **Status:** Draft
* **Suggested repo path:** `/docs/specs/08_ui_ux_foundations_v0.1.md`

## 2) Purpose

Define implementable UI/UX foundations for Field-Kit v0.1 that:

* Preserve the **Field** mental model: a persistent set of **Items** backed by an **append-only ledger** of **QDPIEvents**.
* Support the core loop without turning the product into a chat UI:
  **Create Item → (optional) pick/write prompt → Run → new Item appears**
* Enforce v0.1 constraints: **Private • Local**, no accounts, no cloud sync, no collaboration, no publishing, no payments.
* Provide minimal surfaces with progressive disclosure, and “magic” visuals only at invocation moments (suggestions/proposals, running, streaming).

## 3) Terms

### Terms (v0.1)

* **Episode:** A local, user-owned container for one working session. Every persisted object and every QDPIEvent belongs to exactly one Episode via `episode_id`.
* **Item:** A persistent node of content in the Field, created by a user or generated by an operator. Items are addressable by ID and include a `type` (e.g., `Q`, `M`, `D`, `H`) plus content and minimal metadata.
* **Bond:** A persistent instruction that connects one or more input Items to an operator run. `prompt_text` is the primary instruction. Bonds are created as `status:"draft"` and may be executed; execution generates exactly one output Item and MUST set `status:"executed"` and `output_item_id`.
* **QDPIEvent:** An append-only event record that logs meaningful actions and results. Each event includes `qdpi` (Queue/Monologue/Dialogue/Holologue), `direction` (user→field or system→field), a `name`, a timestamp, and refs to related object IDs.
* **Proposal:** A system suggestion (e.g., suggested Bond prompts) that is logged as events only until the user explicitly confirms creation.
* **Canon:** A user-curated projection over Items/Bonds within an Episode used for presentation or replay. Canon never overrides the append-only event log.
* **Bundle:** A structured artifact output of a Holologue run (many→one) capturing what was selected, what was generated, and any optional proposals. A Bundle may be represented as a single output Item plus an exportable JSON payload.

## 4) Scope and Non-goals (v0.1)

### In scope

* A single **primary surface**: **Field**
* One **operator drawer** (morphing) with three modes:

  * **suggestions/proposals** → **prompt editor** → **run state**
* One **ledger drawer** providing:

  * Objects (Items, Bonds, Episodes; optionally Networks if present elsewhere)
  * Events (QDPIEvent list)
  * JSON preview/export for the selected object/event
  * A derived curated view: **Curated (Canon Projection)**
* Optional **tutorial banner/stepper** overlay (non-blocking; dismissible)
* Credits (local-only simulation) display and event logging
* Latency UX that guarantees “never dead air” while respecting v0.1 persistence semantics (see §9)

### Non-goals (explicitly out of scope for v0.1)

* Accounts, sign-in, identity, profiles
* Cloud sync, collaboration, sharing, publishing, multi-device continuity
* Payments providers, subscriptions, crypto/blockchain, KYC/AML, cash-out
* Transferable/redeemable credits or any value transfer
* Multi-pane workspaces, plugin marketplaces, theme systems
* Mandatory onboarding (tutorial must be optional and dismissible)

### Hard constraints

* v0.1 is **Private • Local**:

  * Episode, Items, Bonds, events, and credits balance are stored locally.
  * No network dependency is required to browse the Field or Ledger.
* Credits are **local-only simulation**:

  * Inspectable via `credits.delta` events
  * Not transferable, not redeemable

## 5) UX North Stars

### 5.1 Flow-state rules

* **Always show the Field first.** No splash, no modal-first onboarding.
* **Never block reading.** Drawers/overlays must not prevent viewing existing Items.
* **Never dead air.** Any “Run” action must produce immediate visible progress (ephemeral run card + run state).
* **Prefer one decisive path.** Primary CTA is **Create Item**; “magic” actions remain discoverable.

### 5.2 Progressive disclosure

* Surface only what’s needed next:

  * No advanced operator settings exposed by default.
  * No required operator configuration in v0.1 UI.
* Suggestions/proposals appear contextually (selection / post-create), not as persistent clutter.

### 5.3 Discoverable, not demanded

* Users can:

  * Ignore suggestions/proposals
  * Close drawers
  * Continue creating Items without running operators
* The product never requires:

  * Naming an Episode up front
  * Choosing an operator before creating content
  * Running a tutorial

### 5.4 v0.1 defaults (choose, don’t ask)

* **Field layout:** single column list; responsive width only (no extra surfaces).
* **Selection model:** single select by click; multi-select via Shift-click / Cmd-click; long-press on touch.
* **New Item ordering:** append to the **bottom**; auto-scroll to new content (see §6.1).

## 6) Information Architecture: Surfaces and Navigation

### 6.1 Primary surface: Field

**Definition:** The Field is the persistent view of Items in the active Episode.

**Header (always visible):**

* Left: Episode label (human-readable name if present; else short ID)
* Right:

  * **“Private” chip** (always visible)
  * **“Credits: N” chip** (always visible)
  * **“Ledger”** button (opens ledger drawer)

**Empty state (no Items):**

* Title text: **“Blank Field”**
* Primary button: **“Create Item”**
* Secondary button/link: **“Start Guided Tutorial”**

**Item ordering (v0.1):**

* Items render in chronological order **top → bottom**.
* New persisted Items (user-created or generated) append to the **bottom**.
* Auto-scroll behavior:

  * If the user is “near bottom” when a new Item arrives, keep the latest Item in view.
  * If the user is not near bottom, do not force scroll; show a subtle “Jump to latest” affordance.

**Selection behaviors:**

* Selecting one or more Items may open the operator drawer in **suggestions/proposals** mode.
* Selecting Items must not steal focus from active text input elsewhere.

### 6.2 Operator drawer (morphing)

**Definition:** A single drawer component that shifts between three modes:

1. **Suggestions/Proposals mode**
2. **Prompt editor mode** (Bond draft)
3. **Run state mode** (running/streaming/result)

**Placement (fixed v0.1 defaults):**

* **Desktop:** operator drawer is a **right** side panel
* **Mobile:** operator drawer is a **bottom sheet**

  * On mobile, only one drawer (operator or ledger) may be open at a time.

**Open triggers (v0.1):**

* Create flow: after saving a new Item via **Create Item**, open suggestions/proposals for that Item.
* Selection: selecting Items opens suggestions/proposals.
* Explicit actions: **Create Bond**, **Run Bond**, **Run Holologue**.

**Close triggers:**

* `Esc` closes drawer (if no unsaved prompt edits)
* Close button (top-right of drawer)
* On mobile, tapping outside closes if safe (no unsaved edits)

### 6.3 Ledger drawer

**Definition:** A drawer that reveals the append-only event log and persisted objects.

**Placement (fixed v0.1 defaults):**

* **Desktop:** ledger drawer is a **left** side panel
* **Mobile:** ledger drawer is a **bottom sheet**

  * On mobile, only one drawer (operator or ledger) may be open at a time.

**Tabs (v0.1):**

* **Objects**

  * Items
  * Bonds
  * Episodes
  * (Optional) Networks, if present elsewhere in v0.1
* **Events**

  * QDPIEvent stream
* **Curated (Canon Projection)**

  * Derived list of curated IDs and their current resolved Items/Bonds
  * No “Canon object” is shown or edited here (projection only)
* **JSON**

  * Preview/export for selected object/event (and derived projection exports)

**Minimum affordances:**

* Search/filter by:

  * object category (Items/Bonds/Episodes/Networks)
  * event `name`
  * `qdpi`
  * `direction`
* Copy JSON to clipboard
* Export options:

  * Export Episode JSON (includes persisted objects/events + curated IDs)
  * Export **Curated (Canon Projection)** as a derived export (projection payload)

### 6.4 Tutorial banner/stepper (optional overlay)

* Entry points:

  * Empty state: **Start Guided Tutorial**
  * Optional help icon in header (non-prominent)
* Requirements:

  * Dismissible
  * Non-blocking (Field remains visible)
  * State stored locally (preferably recorded via canonical events; see §12)

### 6.5 Simple ASCII wireframe (v0.1)

```
+------------------------------------------------------------------+
| Episode: [Local Session]                      [Private][Credits: N]
|                                                     [Ledger]     |
+------------------------------------------------------------------+
|                                                                  |
|  [Blank Field]                                                   |
|  (or Item cards listed here, oldest at top → newest at bottom)   |
|                                                                  |
|  [Create Item]   [Start Guided Tutorial]                         |
|                                                                  |
|  --------------------------------------------------------------  |
|  | Item Card (type: Q)                                         | |
|  | Content preview...                                          | |
|  --------------------------------------------------------------  |
|                                                                  |
|  --------------------------------------------------------------  |
|  | Ephemeral Run Card (NOT SAVED YET)                           | |
|  | shimmer / streaming output                                  | |
|  --------------------------------------------------------------  |
|                                                                  |
+------------------------------------------------------------------+
| Ledger Drawer (left)                         Operator Drawer (right)|
+------------------------------------------------------------------+
```

## 7) Component Inventory

### 7.1 Chips

* **“Private” chip** (required)

  * Static indicator: local-only mode
  * No dropdown in v0.1
* **“Credits: N” chip** (required)

  * Read-only indicator
  * Micro-interaction on change (see §9.6)
* Optional filter chips (Ledger drawer only)

  * Event `qdpi` filter
  * Event `direction` filter
  * Event `name` filter

### 7.2 Buttons and copy anchors (canonical labels)

These labels must appear exactly as written:

* **“Blank Field”**
* **“Create Item”**
* **“Start Guided Tutorial”**
* **“Create Bond”**
* **“Run Bond”**
* **“Run Holologue”**
* **“Ledger”**
* **“Saved ✓ … · View Ledger”**
* **“Private”** (chip)
* **“Credits: N”** (chip)

### 7.3 Item cards (persisted)

**Card anatomy (v0.1):**

* Type pill (e.g., `Q`, `M`, `D`, `H`)
* First line/title (derived from first non-empty line of content)
* Body preview (2–6 lines)
* Minimal metadata row:

  * created timestamp (relative)
  * provenance indicator: user/system
  * ID affordance (copy / reveal)
* Expand/collapse body
* Overflow menu:

  * Copy content
  * Copy ID
  * Open in Ledger (focus Objects tab + JSON)

**Note:** Persisted Items do not have “pending/streaming” persistence states in v0.1. Streaming is represented via an ephemeral run card (see §7.4, §9).

### 7.4 Ephemeral run card (UI-only)

**Definition:** A non-persisted Field card used to guarantee “never dead air” during runs.

* Visually distinct from Items:

  * Label: “Not saved yet” / “Ephemeral”
  * No persistent ID
  * Clear lifecycle (disappears or converts to a persisted Item on success)
* Contains:

  * Shimmer/skeleton while generating
  * Streaming text output
  * A “View Ledger” affordance (opens Ledger Events tab)

### 7.5 Proposal cards (suggestions/proposals mode)

* Render inside operator drawer
* Each card contains:

  * Suggested prompt label (1 line)
  * Prompt preview (2–4 lines)
  * Primary action: **Create Bond**
  * Secondary action: “Preview” (optional; stays in drawer)
* Proposals are **not** persisted as Bonds until the user presses **Create Bond**.

### 7.6 Prompt editor (Bond draft)

* Inputs:

  * `prompt_text` multiline editor (primary)
  * Selected input Items list (read-only summary + remove item)
* Actions:

  * **Run Bond** (enabled when `prompt_text` non-empty and ≥1 input Item selected)
  * Cancel (returns to suggestions/proposals or closes drawer)

### 7.7 Refinement chips (prompt helpers)

* Optional, lightweight, typographic
* Applying a chip modifies `prompt_text` (prefix/suffix/inline)
* Always editable after application (no locked templates)

### 7.8 Run state panel (operator drawer)

* Shows:

  * Mode: Bond or Holologue
  * Input summary (count + short previews)
  * Live status (generating/streaming/finalizing)
* Controls:

  * “Stop” (halts streaming; treated as a failed run in event log via canonical failure events)
  * View Ledger (opens ledger drawer focused on relevant events)

### 7.9 Toasts

* Success toast (canonical copy):

  * **“Saved ✓ … · View Ledger”**
  * “View Ledger” deep-links to the relevant event(s)/object(s)
* Error toast (v0.1):

  * Short message + “View Ledger”
  * Details in operator drawer + Ledger JSON

### 7.10 Drawers (operator + ledger)

* Drawer behavior requirements:

  * Trap focus while open (keyboard)
  * Restore focus to invoker on close
  * Preserve Field scroll position
* Mobile rule: only one drawer open at a time; opening one closes the other.

### 7.11 Modals (use sparingly)

Allowed in v0.1:

* Export confirmation (Episode JSON / Curated projection export)
* Start new Episode (if implemented)

Not allowed in v0.1:

* Blocking onboarding modal
* Payment/account modals

## 8) Core Interaction Loops

### 8.1 Core loop

**Create Item → (optional) pick/write prompt → Run → new Item appears**

1. User clicks **Create Item**
2. Composer opens (v0.1 default: modal)

   * Choose type (`Q` default)
   * Enter content
   * Save
3. The new Item appears at the **bottom** of the Field; auto-scroll brings it into view
4. Operator drawer opens in suggestions/proposals mode (non-blocking)
5. User either:

   * ignores suggestions and continues creating Items, or
   * selects a Proposal → **Create Bond** → **Run Bond**
6. During run:

   * an **ephemeral run card** appears at the bottom immediately
   * output streams into it
7. On success:

   * a persisted output Item is created and appended at the bottom
   * the ephemeral run card is replaced by the real Item card
   * success toast **Saved ✓ … · View Ledger** appears

### 8.2 Tap Item → suggestions/proposals (Proposal-first)

**Trigger:** user selects one or more Item cards

* Operator drawer opens in suggestions/proposals mode showing:

  * Suggestions for the current selection
  * For multi-select, include a Holologue path with **Run Holologue**
* Suggestions/proposals must not require action; closing the drawer leaves the Field unchanged.

### 8.3 Create Bond (explicit confirmation)

**Rule:** A Proposal is not a Bond until user confirms.

* From a Proposal card, pressing **Create Bond**:

  * persists a Bond with `status:"draft"`
  * opens prompt editor populated with proposed `prompt_text`
* User can edit prompt freely before running.

### 8.4 Run Bond (one output Item)

**From prompt editor:**

* Press **Run Bond**
* UI must:

  * transition operator drawer to run state
  * create an ephemeral run card immediately (Field, bottom)
  * stream text into the ephemeral run card

**On success:**

* Persist output Item
* Update Bond to `status:"executed"` and set `output_item_id` (persisted)
* Append relevant canonical completion events and store commit events (see §12)
* Show **Saved ✓ … · View Ledger**

**On failure:**

* Do not persist an output Item
* Show error details in operator drawer
* Ephemeral run card becomes an ephemeral error summary (dismissible) or is removed when leaving run state
* Ledger records the failure via canonical events (see §12)

### 8.5 Run Holologue (many → one Bundle)

**Trigger:** multi-select 2+ Items and choose **Run Holologue** (from suggestions/proposals mode).

* Before running, validate selection:

  * If invalid, show inline validation error in operator drawer and log `holologue.validation_failed` (no ephemeral run card).
* If valid:

  * ephemeral run card appears immediately (Field, bottom)
  * streamed output is a structured Bundle-like text (sections)
* On success:

  * persist a single output Item representing the Bundle (text)
  * offer derived JSON export in Ledger JSON tab (Bundle payload)
  * show **Saved ✓ … · View Ledger**

### 8.6 Open Ledger (inspectability-first)

**Trigger:** click **Ledger** in header or “View Ledger” in toast

* Ledger opens to the most relevant context:

  * From toast: focus the newest events for the action
  * From Item overflow menu: focus that Item in Objects tab + JSON
* Ledger must enable users to verify:

  * the event trail that produced an Item
  * the object JSON (Item/Bond/Episode) and event refs
  * credits deltas and reasons

## 9) Latency & Loading States

### 9.1 Never dead air (global rules)

For any **Run Bond** or **Run Holologue** action:

* **Ephemeral placeholder in the Field immediately:** show an ephemeral run card at the bottom right away.
* **Shimmer/skeleton while generating:** ephemeral card body renders skeleton state.
* **Token streaming into the ephemeral card:** characters/tokens appear incrementally.
* **Blur→sharp / shimmer→final transition:** when generation finalizes, transition to final rendering *before* persistence UI confirmation.
* **No phantom persisted objects:** until success, nothing is persisted as an output Item.

### 9.2 Persistence semantics (v0.1)

**Key rule:** The placeholder output card is **UI-only** until success.

* **On success**

  * Persist the output Item (append to Field bottom)
  * Persist Bond updates (if applicable) and any other changed objects
  * Log completion event (`bond.executed` or `holologue.completed`) and `store.commit`
  * Replace the ephemeral run card with the real Item card

* **On failure**

  * Do **not** persist an output Item
  * Log failure event (`bond.execution_failed` / `holologue.failed` / `holologue.validation_failed`)
  * If a persistence attempt failed, log `store.commit_failed`
  * Keep the Field consistent:

    * Either remove the ephemeral run card when exiting run state, or
    * Convert it to an ephemeral error summary card labeled “Not saved” (dismissible)
  * Error details belong in operator drawer + Ledger

**No new core objects:** Do not introduce a “Run” object or any additional persisted lifecycle objects in v0.1.

### 9.3 Explicit UI states (ephemeral run card + operator drawer)

Ephemeral run card states:

* **pending (ephemeral)**

  * Created immediately on Run request
  * Body: skeleton + “Generating…” (no spinner-only)
* **streaming (ephemeral)**

  * Body: live text streaming
  * “Magic” visuals allowed (shimmer/subtle glow)
* **finalizing (ephemeral)**

  * Body: blur→sharp / shimmer→final transition
* **error (ephemeral)**

  * Short summary + “View Ledger”
  * Explicit “Not saved” label
  * Dismissible

Operator drawer run state mirrors these statuses and owns detailed errors/retry controls.

### 9.4 Debounce and rendering constraints

* Streaming updates must:

  * Append to visible text without reflowing the entire Field list
  * Debounce paint to a stable cadence to avoid jank
* Do **not** log an event per token; the event log stays within the canonical names list (see §12).

### 9.5 Retry and “Stop” behavior (v0.1)

* **Retry**

  * A retry is a new run request (same or edited prompt), producing a new ephemeral run card.
  * Only successful runs create persisted output Items.
* **Stop**

  * Stops streaming immediately.
  * Logs a canonical failure event (`bond.execution_failed` or `holologue.failed`) with a reason indicating user stop (in event refs).
  * No output Item is persisted.

### 9.6 Credits UI (v0.1 simulation)

**Display (required):**

* Small top-right chip: **“Credits: N”**
* Brief microflash on change:

  * “+” flash for increase, “–” flash for decrease (subtle, short; not celebratory)

**Event logging (required):**

* Credits changes must append a QDPIEvent:

  * `name`: `credits.delta`
  * `qdpi`: `"Q"`
  * `direction`: `"system→field"`
  * `refs` includes:

    * `delta`
    * `balance_after`
    * `reason`
    * optional related IDs
* Numeric amounts are policy-configured elsewhere; this document does not specify values.

## 10) Visual Language

### 10.1 Minimal by default (base layer)

* Calm, typographic, whitespace-forward
* Avoid persistent gradients, sparkles, glowing borders, animated noise
* Prefer:

  * neutral surfaces
  * hierarchy via type scale and spacing
  * subtle dividers and card edges

### 10.2 Magical at invocation (micro-layer)

“Magic” visuals (sparkle icon, gradient glow, shimmer, streaming effects) are permitted **only** when:

1. Showing suggestions/proposals (inside operator drawer suggestions/proposals mode)
2. Running Bond/Holologue (operator drawer run state + ephemeral run card)
3. Streaming an output (ephemeral run card while tokens arrive)

Disallowed in v0.1:

* Persistent sparkles on the Field background
* Always-on animated gradients
* Confetti/reward animations (including on credit changes)

### 10.3 Status styling rules

* Persisted Items: plain, sharp text
* Ephemeral run card:

  * pending/streaming: shimmer + subtle highlight
  * error: clear “Not saved” label + “View Ledger” affordance

## 11) Accessibility & Input

### 11.1 Typography defaults

* Comfortable reading defaults:

  * adequate line-height
  * clear paragraph spacing
  * avoid ultra-light body weights
* Ensure contrast meets common accessibility expectations.

### 11.2 Keyboard shortcuts (v0.1)

* `N`: **Create Item**
* `L`: toggle **Ledger** drawer
* `Esc`: close the topmost drawer/modal (respect unsaved prompt edits)
* `Cmd+Enter` / `Ctrl+Enter` in prompt editor: **Run Bond** (when enabled)
* Arrow keys:

  * Navigate Item cards when Field is focused
* `Space` / `Enter` on focused Item:

  * Select Item (and open suggestions/proposals)

### 11.3 Focus management (requirements)

* Opening operator drawer:

  * suggestions/proposals: focus first suggestion/proposal card
  * prompt editor: focus prompt textarea
  * run state: focus run controls (Stop / View Ledger)
* Closing a drawer returns focus to the invoker (button / Item card).
* Modals trap focus and are escapable.

### 11.4 Input modes

* Mouse/touch parity:

  * Long-press to multi-select on touch
  * Shift/Cmd modifiers on desktop
* No drag-and-drop required in v0.1.

## 12) Event-to-UI Mapping

**Rule:** The v0.1 event log uses **only** the canonical event names below. Intermediate UI phases (e.g., streaming, placeholder display, “run started”) are **UI state only** and must not introduce new event names.

### 12.1 Canonical event names (v0.1)

* `app.first_run.started`
* `episode.created`
* `field.opened`
* `tutorial.started`
* `item.created`
* `bond.suggestions.presented`
* `bond.draft_created`
* `bond.run_requested`
* `bond.executed`
* `bond.execution_failed`
* `holologue.run_requested`
* `holologue.validation_failed`
* `holologue.completed`
* `holologue.failed`
* `bond.proposals.presented`
* `ledger.opened`
* `store.commit`
* `store.commit_failed`
* `credits.delta`

### 12.2 QDPI and direction scheme (v0.1-aligned)

Use these tags consistently:

* **Q (Queue):** requests + inspection + bookkeeping
  Examples: `bond.run_requested`, `ledger.opened`, `store.commit`, `credits.delta`, suggestions/proposals presented
* **D (Dialogue):** user-confirmed structure decisions
  Examples: `bond.draft_created`
* **M (Monologue):** system-produced completions / outputs
  Examples: `bond.executed`, `bond.execution_failed` (when applicable)
* **H (Holologue):** holologue lifecycle
  Examples: `holologue.run_requested`, `holologue.completed`, `holologue.failed`, `holologue.validation_failed`

Use only:

* `direction: user→field`
* `direction: system→field`

### 12.3 High-level mapping: UI actions → events

#### App lifecycle

* App enters first-run state

  * Event: `app.first_run.started`
  * qdpi: `Q`
  * direction: `system→field`

* Episode is created (first run or user starts a new one)

  * Event: `episode.created`
  * qdpi: `Q`
  * direction: `system→field`
  * refs: `episode_id`

* Field is opened (Episode becomes active in UI)

  * Event: `field.opened`
  * qdpi: `Q`
  * direction: `user→field`
  * refs: `episode_id`

#### Tutorial

* User presses **Start Guided Tutorial**

  * Event: `tutorial.started`
  * qdpi: `Q`
  * direction: `user→field`
  * refs: `episode_id` (and optional tutorial step info)

#### Creating Items

* User saves a new Item via **Create Item**

  * Event: `item.created`
  * qdpi: `Q`
  * direction: `user→field`
  * refs: `item_id`, `episode_id`, `type`

* System persists the change

  * Event: `store.commit`
  * qdpi: `Q`
  * direction: `system→field`
  * refs: `episode_id` (and optional affected IDs)

* If persistence fails

  * Event: `store.commit_failed`
  * qdpi: `Q`
  * direction: `system→field`
  * refs: `episode_id`, error info

#### Suggestions / proposals

* User selects Items (or completes Create Item) and the system shows suggestions

  * Event: `bond.suggestions.presented`
  * qdpi: `Q`
  * direction: `system→field`
  * refs: `episode_id`, selected `item_id`s (and optional scoring/why)

* System shows concrete Proposal cards (prompts) in the operator drawer

  * Event: `bond.proposals.presented`
  * qdpi: `Q`
  * direction: `system→field`
  * refs: `episode_id`, selected `item_id`s (and proposal descriptors)

#### Bond draft + run

* User confirms **Create Bond** from a Proposal

  * Event: `bond.draft_created`
  * qdpi: `D`
  * direction: `user→field`
  * refs: `bond_id`, `episode_id`, input `item_id`s

* System persists the Bond draft

  * Event: `store.commit` (or `store.commit_failed`)
  * qdpi: `Q`
  * direction: `system→field`

* User presses **Run Bond**

  * Event: `bond.run_requested`
  * qdpi: `Q`
  * direction: `user→field`
  * refs: `bond_id`, `episode_id`

* UI-only: show ephemeral run card + streaming output (no event name)

* On successful completion (system output persisted)

  * Event: `bond.executed`
  * qdpi: `M`
  * direction: `system→field`
  * refs: `bond_id`, `episode_id`, `output_item_id`

* Persist results

  * Event: `store.commit`
  * qdpi: `Q`
  * direction: `system→field`

* On failure (no output Item persisted)

  * Event: `bond.execution_failed`
  * qdpi: `M`
  * direction: `system→field`
  * refs: `bond_id`, `episode_id`, error info (and reason if user stopped)

* If a persistence attempt failed

  * Event: `store.commit_failed`
  * qdpi: `Q`
  * direction: `system→field`

#### Holologue run

* User presses **Run Holologue**

  * Event: `holologue.run_requested`
  * qdpi: `H`
  * direction: `user→field`
  * refs: `episode_id`, input `item_id`s

* If validation fails (no run / no ephemeral card)

  * Event: `holologue.validation_failed`
  * qdpi: `H`
  * direction: `system→field`
  * refs: `episode_id`, reason

* UI-only: if valid, show ephemeral run card + streaming output (no event name)

* On successful completion (output Item persisted; Bundle represented as Item + optional JSON)

  * Event: `holologue.completed`
  * qdpi: `H`
  * direction: `system→field`
  * refs: `episode_id`, `output_item_id`, (optional) Bundle export refs

* Persist results

  * Event: `store.commit`
  * qdpi: `Q`
  * direction: `system→field`

* On failure (no output Item persisted)

  * Event: `holologue.failed`
  * qdpi: `H`
  * direction: `system→field`
  * refs: `episode_id`, error info (and reason if user stopped)

* If a persistence attempt failed

  * Event: `store.commit_failed`
  * qdpi: `Q`
  * direction: `system→field`

#### Ledger

* User opens **Ledger**

  * Event: `ledger.opened`
  * qdpi: `Q`
  * direction: `user→field`
  * refs: `episode_id`

#### Credits

* System updates simulated credits balance

  * Event: `credits.delta`
  * qdpi: `Q`
  * direction: `system→field`
  * refs: `delta`, `balance_after`, `reason`, optional related IDs

### 12.4 UI-to-event consistency rules

* If an Item/Bond/Episode appears as a persisted object, there must be:

  * a canonical creation/completion event, and
  * a `store.commit` confirming persistence (or `store.commit_failed` for failed attempts).
* Ephemeral UI elements (run cards, streaming text) must not be represented as persisted objects.

## 13) Definition of Done (UI/UX) — Implementable Checklist

### Surfaces

* [ ] Field is the only primary surface; it loads directly into the active Episode
* [ ] Operator drawer exists and morphs: suggestions/proposals → prompt editor → run state
* [ ] Ledger drawer exists (desktop left) with tabs:

  * [ ] Objects (Items, Bonds, Episodes; optional Networks)
  * [ ] Events
  * [ ] Curated (Canon Projection)
  * [ ] JSON
* [ ] Tutorial banner/stepper exists and is optional + dismissible
* [ ] Mobile: operator/ledger are bottom sheets; only one open at a time

### Copy anchors

* [ ] Empty state includes **“Blank Field”**
* [ ] Primary CTA is **“Create Item”**
* [ ] Tutorial entry includes **“Start Guided Tutorial”**
* [ ] Operator drawer includes **“Create Bond”**, **“Run Bond”**, **“Run Holologue”**
* [ ] Header includes **“Ledger”**
* [ ] Toast copy matches **“Saved ✓ … · View Ledger”**
* [ ] Header chips include **“Private”** and **“Credits: N”**

### Item ordering

* [ ] Persisted Items append to the **bottom** of the Field
* [ ] Auto-scroll keeps latest in view when user is near bottom
* [ ] “Jump to latest” affordance exists when user is scrolled up

### Minimal-by-default / magical-at-invocation

* [ ] Base Field UI is calm, typographic, whitespace-forward
* [ ] Sparkle/gradient/shimmer/streaming visuals appear ONLY when:

  * [ ] showing suggestions/proposals
  * [ ] running Bond/Holologue
  * [ ] streaming output (ephemeral run card)

### Latency UX (never dead air, v0.1 persistence semantics)

* [ ] On **Run Bond** / **Run Holologue**, an **ephemeral** run card appears immediately in the Field
* [ ] Ephemeral card uses skeleton/shimmer while generating
* [ ] Tokens stream into the ephemeral card body
* [ ] Blur→sharp / shimmer→final transition occurs on finalization
* [ ] On success:

  * [ ] output Item is persisted and appended to Field bottom
  * [ ] ephemeral run card converts into the persisted Item card
* [ ] On failure/validation failure:

  * [ ] no output Item is persisted
  * [ ] error UI is shown in operator drawer + Ledger
  * [ ] ephemeral run card is clearly “Not saved” and dismissible (or removed on exit)

### Credits (local-only simulation)

* [ ] Credits chip **“Credits: N”** is visible at top-right
* [ ] Chip microflashes subtly on balance change (+/–)
* [ ] Every credits change appends `credits.delta` with required fields and correct qdpi/direction
* [ ] Balance displayed in chip is derived from events (no hidden state)

### Ledger inspectability

* [ ] Ledger shows persisted objects (Items/Bonds/Episodes) and event stream (QDPIEvents)
* [ ] “Curated (Canon Projection)” shows derived curated view (no Canon object)
* [ ] Selecting any object/event shows JSON preview
* [ ] “View Ledger” deep-links to the relevant event(s)/object(s)
* [ ] Exports:

  * [ ] Episode JSON export exists
  * [ ] Curated (Canon Projection) derived export exists

### Accessibility & input

* [ ] Keyboard shortcuts implemented: `N`, `L`, `Esc`, `Cmd/Ctrl+Enter`
* [ ] Focus management is correct when opening/closing drawers/modals
* [ ] Item navigation works via keyboard (focusable cards, Enter/Space selects)

### v0.1 constraints honored

* [ ] No account flows, no publishing, no collaboration, no cloud sync
* [ ] No payments/crypto/KYC/AML/cash-out surfaces or language
* [ ] Credits are local simulation only; not redeemable/transferable